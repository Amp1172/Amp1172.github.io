<!DOCTYPE html>
<html>
<head>
    <title>Book Details</title>
</head>
<body>
    <h1 id="book-title"></h1>
    <p id="book-author"></p>
    <p id="book-status"></p>

    <div id="borrow-form" style="display: none;">
        <input type="text" id="member-id" placeholder="Member ID">
        <button onclick="borrowBook()">Borrow</button>
    </div>

    <div id="return-form" style="display: none;">
        <button onclick="returnBook()">Return</button>
    </div>

    <a href="index.html">Back to Library</a>

    <script>
        const scriptURL = 'YOUR_GOOGLE_APPS_SCRIPT_URL'; // แทนที่ด้วย URL ของ Google Apps Script ของคุณ
        const urlParams = new URLSearchParams(window.location.search);
        const bookId = urlParams.get('id');

        fetch(scriptURL + `?action=getBook&id=${bookId}`)
            .then(response => response.json())
            .then(book => {
                document.getElementById('book-title').textContent = book.title;
                document.getElementById('book-author').textContent = book.author;
                document.getElementById('book-status').textContent = 'Availability: ' + book.status;

                if (book.status === 'Available') {
                    document.getElementById('borrow-form').style.display = 'block';
                } else if (book.status === 'Borrowed') {
                    document.getElementById('return-form').style.display = 'block';
                }
            });

        function borrowBook() {
            const memberId = document.getElementById('member-id').value;
            fetch(scriptURL, {
                method: 'POST',
                body: JSON.stringify({ action: 'borrowBook', bookId: bookId, memberId: memberId })
            })
            .then(response => response.json())
            .then(result => {
                alert(result.message);
                location.reload();
            });
        }

        function returnBook() {
            fetch(scriptURL, {
                method: 'POST',
                body: JSON.stringify({ action: 'returnBook', bookId: bookId })
            })
            .then(response => response.json())
            .then(result => {
                alert(result.message);
                location.reload();
            });
        }
    </script>
</body>
</html>
